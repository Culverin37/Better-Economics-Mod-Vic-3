namespace = pec_twoparty

pec_twoparty.1 = {
	type = country_event
	placement = root
	title = pec_twoparty.1.t
	desc = pec_twoparty.1.d
	flavor = pec_twoparty.1.f

	duration = 3

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	event_image = {
		video = "unspecific_politicians_arguing"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	immediate = {
		set_variable = pec_twopartyevent1
	}

	trigger = {
		NOT = { has_modifier = pec_two_party_system }
		NOT = { has_modifier = pec_two_party_system_socialist }
		NOT = { has_modifier = pec_multiparty_system }
		NOT = { has_variable = pec_twopartyevent1 }
		OR = {
			has_law = law_type:law_monarchy
			has_law = law_type:law_presidential_republic
		}
		OR = {
			has_law = law_type:law_landed_voting
			has_law = law_type:law_wealth_voting
			has_law = law_type:law_census_voting
			has_law = law_type:law_universal_suffrage
		}
	}

	option = {
		name = pec_twoparty.1.a # no need
		default_option = yes
		ai_chance = {
			base = 25
			modifier = {
				trigger = {
					OR = {
						country_has_primary_culture = cu:yankee
						country_has_primary_culture = cu:dixie
					}
				}
				add = -20
			}
		}
		custom_tooltip = {
			text = pec_multiparty_tt
		}
		add_modifier = {
			name = pec_multiparty_system
			months = -1
		}
		remove_variable = pec_twopartyevent1
	}

	option = {
		name = pec_twoparty.1.b # two party go
		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					OR = {
						country_has_primary_culture = cu:platinean
						country_has_primary_culture = cu:south_andean
						country_has_primary_culture = cu:north_andean
						country_has_primary_culture = cu:central_american
						country_has_primary_culture = cu:mexican
						country_has_primary_culture = cu:yankee
						country_has_primary_culture = cu:dixie
						country_has_primary_culture = cu:australian
						country_has_primary_culture = cu:anglo_canadian
						country_has_primary_culture = cu:franco_canadian
						country_has_primary_culture = cu:afro_antillean
						country_has_primary_culture = cu:afro_american
						country_has_primary_culture = cu:afro_caribbean
						country_has_primary_culture = cu:afro_caribeno
						country_has_primary_culture = cu:afro_brazilian
						country_has_primary_culture = cu:caribeno
						country_has_primary_culture = cu:brazilian
						country_has_primary_culture = cu:british
					}
				}
				add = 130
			}
		}
		custom_tooltip = {
			text = pec_twopartyliberal_tt
		}
		add_modifier = {
			name = pec_two_party_system
			months = -1
		}
		remove_variable = pec_twopartyevent1
		hidden_effect = {
			if = {
				limit = {
					has_law = law_type:law_presidential_republic
					in_election_campaign = yes
				}
				trigger_event = {
					id = pec_twoparty.5
					days = 185
				}
			}
			if = {
				limit = {
					has_law = law_type:law_monarchy
					in_election_campaign = yes
				}
				trigger_event = {
					id = pec_twoparty.7
					days = 185
				}
			}
		}
		update_party_support = yes
	}
}

pec_twoparty.2 = {
	type = country_event
	placement = root
	title = pec_twoparty.2.t
	desc = pec_twoparty.2.d
	flavor = pec_twoparty.2.f

	duration = 3

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	event_image = {
		video = "unspecific_politicians_arguing"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_industry.dds"

	immediate = {
		set_variable = pec_twopartyevent2
	}

	trigger = {
		in_election_campaign = yes
		ig:ig_trade_unions = {
			is_powerful = yes
		}
		has_modifier = pec_two_party_system
		NOT = { has_variable = pec_twopartyevent2 }
		NOT = { has_variable = pec_rejected_socialist_twoparty }
		ig:ig_intelligentsia = {
			is_powerful = no
		}
		OR = {
			has_law = law_type:law_monarchy
			has_law = law_type:law_presidential_republic
		}
		OR = {
			has_law = law_type:law_landed_voting
			has_law = law_type:law_wealth_voting
			has_law = law_type:law_census_voting
			has_law = law_type:law_universal_suffrage
		}
	}

	option = {
		name = pec_twoparty.2.a # suppress socialist organizers
		default_option = yes
		ai_chance = {
			base = 10
			modifier = {
				trigger = {
					OR = {
						country_has_primary_culture = cu:yankee
						country_has_primary_culture = cu:dixie
						country_has_primary_culture = cu:platinean
						country_has_primary_culture = cu:south_andean
						country_has_primary_culture = cu:north_andean
					}
				}
				add = 110
			}
			modifier = {
				trigger = {
					any_interest_group = {
						OR = {
							is_interest_group_type = ig_trade_unions
							any_scope_character = {
								has_role = politician
								has_ideology = ideology:ideology_social_democrat
							}
						}
						is_in_government = no
					}
				}
				add = 40
			}
		}
		custom_tooltip = {
			text = pec_twopartysocialistsuppress_tt
		}
		add_radicals = {
			value = large_radicals
			interest_group = ig:ig_trade_unions
		}
		add_radicals = {
			value = small_radicals
			strata = poor
		}
		ig:ig_trade_unions = {
			add_modifier = {
				name = pec_igmod_twoparty_antisocialist_negative
				months = 60
			}
		}
		ig:ig_intelligentsia = {
			add_modifier = {
				name = pec_igmod_twoparty_antisocialist_positive
				months = 60
			}
		}
		set_variable = pec_rejected_socialist_twoparty
	}

	option = {
		name = pec_twoparty.2.b # open up for proportional representation
		ai_chance = {
			base = 20
		}
		custom_tooltip = {
			text = pec_multiparty_tt
		}
		remove_modifier = pec_two_party_system
		add_modifier = {
			name = pec_multiparty_system
			months = -1
		}
		update_party_support = yes
	}

	option = {
		name = pec_twoparty.2.c # the social-democrats have overtaken the liberals
		ai_chance = {
			base = 35
			modifier = {
				trigger = {
					any_interest_group = {
						OR = {
							is_interest_group_type = ig_trade_unions
							any_scope_character = {
								has_role = politician
								has_ideology = ideology:ideology_social_democrat
							}
						}
						is_in_government = yes
					}
				}
				add = 40
			}
		}
		custom_tooltip = {
			text = pec_twopartysocialist_tt
		}
		remove_modifier = pec_two_party_system
		add_modifier = {
			name = pec_two_party_system_socialist
			months = -1
		}
		add_radicals = {
			value = 0.03
			interest_group = ig:ig_intelligentsia
		}
		add_radicals = {
			value = 0.01
			strata = middle
		}
		update_party_support = yes
	}
}

pec_twoparty.3 = {	
	type = country_event 
	hidden = yes
	
	trigger = {
		OR = {
			has_modifier = pec_two_party_system
			has_modifier = pec_two_party_system_socialist
		}
		has_law = law_type:law_presidential_republic						
	}	
		
	immediate = {
		trigger_event = {
			id = pec_twoparty.5
			days = 185
			popup = yes
		}
	}		
}

pec_twoparty.4 = {	
	type = country_event 
	hidden = yes
	
	trigger = {
		OR = {
			has_modifier = pec_two_party_system
			has_modifier = pec_two_party_system_socialist
		}
		has_law = law_type:law_monarchy						
	}	
		
	immediate = {
		trigger_event = {
			id = pec_twoparty.7
			days = 185
		}
	}		
}

pec_twoparty.5 = {
	type = country_event
	placement = root
	title = pec_twoparty.5.t
	desc = pec_twoparty.5.d
	flavor = pec_twoparty.5.f

	duration = 3

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	gui_window = event_window_1char_tabloid
	left_icon = scope:pec_twoparty_presidentelect

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/misc/1Character_Banner"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		ruler = {
			save_scope_as = pec_twoparty_presidentelect
		}
		ruler.interest_group.party = {
			save_scope_as = pec_twoparty_electedparty
		}
	}

	trigger = {
	}

	option = {
		name = pec_twoparty.5.a 
		default_option = yes

		custom_tooltip = {
			text = pec_twoparty5_tt
			every_interest_group = {
				remove_ruling_interest_group = yes
			}
			scope:pec_twoparty_electedparty = {
				every_member = {
					add_ruling_interest_group = yes
				}
			}
		}
		every_scope_character = {
			limit = {
				is_ruler = yes
				has_modifier = pec_igmod_term4
			}
			remove_modifier = pec_igmod_term4
			add_modifier = {
				name = pec_igmod_term5
				months = -1
			}
		}
		every_scope_character = {
			limit = {
				is_ruler = yes
				has_modifier = pec_igmod_term3
			}
			remove_modifier = pec_igmod_term3
			add_modifier = {
				name = pec_igmod_term4
				months = -1
			}
		}
		every_scope_character = {
			limit = {
				is_ruler = yes
				has_modifier = pec_igmod_term2
			}
			remove_modifier = pec_igmod_term2
			add_modifier = {
				name = pec_igmod_term3
				months = -1
			}
		}
		every_scope_character = {
			limit = {
				is_ruler = yes
				has_modifier = pec_igmod_term1
			}
			remove_modifier = pec_igmod_term1
			add_modifier = {
				name = pec_igmod_term2
				months = -1
			}
		}
		every_scope_character = {
			limit = {
				is_ruler = yes
				NOT = { has_modifier = pec_igmod_term1 }
				NOT = { has_modifier = pec_igmod_term2 }
				NOT = { has_modifier = pec_igmod_term3 }
				NOT = { has_modifier = pec_igmod_term4 }
				NOT = { has_modifier = pec_igmod_term5 }
			}
			add_modifier = {
				name = pec_igmod_term1
				months = -1
			}
		}
	}
}

pec_twoparty.6 = {
	type = country_event
	placement = root
	title = pec_twoparty.6.t
	desc = pec_twoparty.6.d
	flavor = pec_twoparty.6.f

	duration = 3

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	event_image = {
		video = "unspecific_politicians_arguing"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		ruler = {
			save_scope_as = pec_twoparty_twotermpresident
		}
		ruler.interest_group.party = {
			save_scope_as = pec_twoparty_twotermparty
		}
	}

	trigger = {
		exists = c:USA
		c:USA = ROOT
		ruler = {
			has_modifier = pec_igmod_term2
		}
	}

	option = {
		name = pec_twoparty.6.a
		default_option = yes
		ai_chance = {
			base = 95
		}
		custom_tooltip = {
			text = pec_twoparty6_tt_a
			every_scope_character = {
				limit = {
					is_ruler = yes
					has_modifier = pec_igmod_term2
				}
				kill_character = yes
			}
		}
	}

	option = {
		name = pec_twoparty.6.b
		ai_chance = {
			base = 5
		}
		custom_tooltip = {
			text = pec_twoparty6_tt_b
			every_scope_character = {
				limit = {
					is_ruler = yes
					has_modifier = pec_igmod_term2
				}
				add_modifier = {
					name = pec_igmod_refused_resign_term
					months = -1
				}
			}
		}
	}
}

pec_twoparty.7 = {
	type = country_event
	placement = root
	title = pec_twoparty.7.t
	desc = pec_twoparty.7.d
	flavor = pec_twoparty.7.f

	duration = 1

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	event_image = {
		video = "unspecific_ruler_speaking_to_people"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"

	icon = "gfx/interface/icons/event_icons/event_newspaper.dds"

	immediate = {
		ruler = {
			save_scope_as = pec_twoparty7_monarch
		}
		if = {
			limit = {
				ruler.interest_group = {
					has_party = yes
				}
			}
			ruler.interest_group.party = {
				save_scope_as = pec_twoparty7_monarchparty
			}
		}
		random_active_party = {
			limit = { is_party_type = liberal_party }
			save_scope_as = pec_twoparty_mon_liberal
		}
		random_active_party = {
			limit = { is_party_type = conservative_party }
			save_scope_as = pec_twoparty_mon_conservative
		}
		random_active_party = {
			limit = { is_party_type = social_democrat_party }
			save_scope_as = pec_twoparty_mon_socialist
		}
	}

	trigger = {
	}

	option = {
		name = pec_twoparty.7.a 
		default_option = yes

		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					scope:pec_twoparty7_monarchparty = {
						is_party_type = conservative_party
					}
				}
				add = 50
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							interest_group_population_percentage >= 0.3
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							interest_group_population_percentage >= 0.2
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							interest_group_population_percentage >= 0.15
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							interest_group_population_percentage >= 0.1
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							ig_clout >= 0.3
						}
					}
				}
				add = 100
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							ig_clout >= 0.25
						}
					}
				}
				add = 80
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							ig_clout >= 0.20
						}
					}
				}
				add = 60
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							ig_clout >= 0.15
						}
					}
				}
				add = 40
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_conservative = {
						any_member = {
							ig_clout >= 0.1
						}
					}
				}
				add = 20
			}
		}

		custom_tooltip = {
			text = pec_twoparty7con_tt
			every_interest_group = {
				remove_ruling_interest_group = yes
			}
			scope:pec_twoparty_mon_conservative = {
				every_member = {
					add_ruling_interest_group = yes
					add_modifier = {
						name = pec_twoparty_monarchappointedparty
						months = 42
					}
				}
			}
		}
		if = {
			limit = {
				ruler.interest_group = {
					has_party = yes
				}
				scope:pec_twoparty7_monarchparty = {
					NOT = { is_party_type = conservative_party }
				}
			}
			add_modifier = {
				name = pec_twoparty_monarch_appoint_other_party
				months = 48
			}
		}
	}

	option = {
		name = pec_twoparty.7.b
		trigger = {
			has_modifier = pec_two_party_system
		}
		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					scope:pec_twoparty7_monarchparty = {
						is_party_type = liberal_party
					}
				}
				add = 50
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							interest_group_population_percentage >= 0.3
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							interest_group_population_percentage >= 0.2
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							interest_group_population_percentage >= 0.15
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							interest_group_population_percentage >= 0.1
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							ig_clout >= 0.3
						}
					}
				}
				add = 100
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							ig_clout >= 0.25
						}
					}
				}
				add = 80
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							ig_clout >= 0.20
						}
					}
				}
				add = 60
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							ig_clout >= 0.15
						}
					}
				}
				add = 40
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_liberal = {
						any_member = {
							ig_clout >= 0.1
						}
					}
				}
				add = 20
			}
		}

		custom_tooltip = {
			text = pec_twoparty7lib_tt

			every_interest_group = {
				remove_ruling_interest_group = yes
			}
			scope:pec_twoparty_mon_liberal = {
				every_member = {
					add_ruling_interest_group = yes
					add_modifier = {
						name = pec_twoparty_monarchappointedparty
						months = 42
					}
				}
			}
		}
		if = {
			limit = {
				ruler.interest_group = {
					has_party = yes
				}
				scope:pec_twoparty7_monarchparty = {
					NOT = { is_party_type = liberal_party }
				}
			}
			add_modifier = {
				name = pec_twoparty_monarch_appoint_other_party
				months = 48
			}
		}
	}

	option = {
		name = pec_twoparty.7.c
		trigger = {
			has_modifier = pec_two_party_system_socialist
		}

		ai_chance = {
			base = 20
			modifier = {
				trigger = {
					scope:pec_twoparty7_monarchparty = {
						is_party_type = social_democrat_party
					}
				}
				add = 50
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							interest_group_population_percentage >= 0.3
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							interest_group_population_percentage >= 0.2
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							interest_group_population_percentage >= 0.15
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							interest_group_population_percentage >= 0.1
						}
					}
				}
				add = 10
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							ig_clout >= 0.3
						}
					}
				}
				add = 100
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							ig_clout >= 0.25
						}
					}
				}
				add = 80
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							ig_clout >= 0.20
						}
					}
				}
				add = 60
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							ig_clout >= 0.15
						}
					}
				}
				add = 40
			}
			modifier = {
				trigger = {
					scope:pec_twoparty_mon_socialist = {
						any_member = {
							ig_clout >= 0.1
						}
					}
				}
				add = 20
			}
		}

		custom_tooltip = {
			text = pec_twoparty7soc_tt
			every_interest_group = {
				remove_ruling_interest_group = yes
			}
			scope:pec_twoparty_mon_socialist = {
				every_member = {
					add_ruling_interest_group = yes
					add_modifier = {
						name = pec_twoparty_monarchappointedparty
						months = 42
					}
				}
			}
		}
			if = {
			limit = {
				ruler.interest_group = {
					has_party = yes
				}
				scope:pec_twoparty7_monarchparty = {
					NOT = { is_party_type = social_democrat_party }
				}
			}
			add_modifier = {
				name = pec_twoparty_monarch_appoint_other_party
				months = 48
			}
		}
	}
}

pec_twoparty.8 = {	
	type = country_event 
	hidden = yes
	
	trigger = {
		has_modifier = pec_twoparty_monarch_appoint_other_party
		ruler.interest_group = {
			has_party = yes
		}
		ruler.interest_group.party = {
			any_member = {
				is_in_government = yes
			}
		}
	}
		
	immediate = {
		remove_modifier = pec_twoparty_monarch_appoint_other_party
	}		
}